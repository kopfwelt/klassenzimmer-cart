<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - app/components/cart/src/storage/service-worker.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>app/components/cart/src/storage/service-worker.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">76.25</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">133</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">10.43</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">0.27</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/* global self, caches, fetch, URL, Response */

// see https://github.com/lyzadanger/serviceworker-example/blob/master/03-versioning/serviceWorker.js
&#039;use strict&#039;;

var config = {
  version: &#039;achilles&#039;,
  staticCacheItems: [
    &#039;/images/lyza.gif&#039;,
    &#039;/css/styles.css&#039;,
    &#039;/js/site.js&#039;,
    &#039;/offline/&#039;,
    &#039;/&#039;
  ],
  cachePathPattern: /^\/(?:(20[0-9]{2}|about|blog|css|images|js)\/(.+)?)?$/,
  offlineImage: &#039;&lt;svg role=&quot;img&quot; aria-labelledby=&quot;offline-title&quot;&#039;
    + &#039; viewBox=&quot;0 0 400 300&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&#039;
    + &#039;&lt;title id=&quot;offline-title&quot;&gt;Offline&lt;/title&gt;&#039;
    + &#039;&lt;g fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;&gt;&lt;path fill=&quot;#D8D8D8&quot; d=&quot;M0 0h400v300H0z&quot;/&gt;&#039;
    + &#039;&lt;text fill=&quot;#9B9B9B&quot; font-family=&quot;Times New Roman,Times,serif&quot; font-size=&quot;72&quot; font-weight=&quot;bold&quot;&gt;&#039;
    + &#039;&lt;tspan x=&quot;93&quot; y=&quot;172&quot;&gt;offline&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&#039;,
  offlinePage: &#039;/offline/&#039;
};

function cacheName (key, opts) {
  return `${opts.version}-${key}`;
}

function addToCache (cacheKey, request, response) {
  if (response.ok) {
    var copy = response.clone();
    caches.open(cacheKey).then( cache =&gt; {
      cache.put(request, copy);
    });
  }
  return response;
}

function fetchFromCache (event) {
  return caches.match(event.request).then(response =&gt; {
    if (!response) {
      throw Error(`${event.request.url} not found in cache`);
    }
    return response;
  });
}

function offlineResponse (resourceType, opts) {
  if (resourceType === &#039;image&#039;) {
    return new Response(opts.offlineImage,
      { headers: { &#039;Content-Type&#039;: &#039;image/svg+xml&#039; } }
    );
  } else if (resourceType === &#039;content&#039;) {
    return caches.match(opts.offlinePage);
  }
  return undefined;
}

self.addEventListener(&#039;install&#039;, event =&gt; {
  function onInstall (event, opts) {
    var cacheKey = cacheName(&#039;static&#039;, opts);
    return caches.open(cacheKey)
      .then(cache =&gt; cache.addAll(opts.staticCacheItems));
  }

  event.waitUntil(
    onInstall(event, config).then( () =&gt; self.skipWaiting() )
  );
});

self.addEventListener(&#039;activate&#039;, event =&gt; {
  function onActivate (event, opts) {
    return caches.keys()
      .then(cacheKeys =&gt; {
        var oldCacheKeys = cacheKeys.filter(key =&gt; key.indexOf(opts.version) !== 0);
        var deletePromises = oldCacheKeys.map(oldKey =&gt; caches.delete(oldKey));
        return Promise.all(deletePromises);
      });
  }

  event.waitUntil(
    onActivate(event, config)
      .then( () =&gt; self.clients.claim() )
  );
});

self.addEventListener(&#039;fetch&#039;, event =&gt; {

  function shouldHandleFetch (event, opts) {
    var request            = event.request;
    var url                = new URL(request.url);
    var criteria           = {
      matchesPathPattern: opts.cachePathPattern.test(url.pathname),
      isGETRequest      : request.method === &#039;GET&#039;,
      isFromMyOrigin    : url.origin === self.location.origin
    };
    var failingCriteria    = Object.keys(criteria)
      .filter(criteriaKey =&gt; !criteria[criteriaKey]);
    return !failingCriteria.length;
  }

  function onFetch (event, opts) {
    var request = event.request;
    var acceptHeader = request.headers.get(&#039;Accept&#039;);
    var resourceType = &#039;static&#039;;
    var cacheKey;

    if (acceptHeader.indexOf(&#039;text/html&#039;) !== -1) {
      resourceType = &#039;content&#039;;
    } else if (acceptHeader.indexOf(&#039;image&#039;) !== -1) {
      resourceType = &#039;image&#039;;
    }

    cacheKey = cacheName(resourceType, opts);

    if (resourceType === &#039;content&#039;) {
      event.respondWith(
        fetch(request)
          .then(response =&gt; addToCache(cacheKey, request, response))
          .catch(() =&gt; fetchFromCache(event))
          .catch(() =&gt; offlineResponse(resourceType, opts))
      );
    } else {
      event.respondWith(
        fetchFromCache(event)
          .catch(() =&gt; fetch(request))
            .then(response =&gt; addToCache(cacheKey, request, response))
          .catch(() =&gt; offlineResponse(resourceType, opts))
      );
    }
  }
  if (shouldHandleFetch(event, config)) {
    onFetch(event, config);
  }

});</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
